$('#btn_search').click(function (e) {
    ajaxCheckIdnumber();
});

$(function () {
    init();
});

function mask(show) {
    if (show) {
        $('.loading').show();
    } else {
        $('.loading').hide();
    }
}

function init() {
    $("#search").show();
    mask(false);
}

// 验证身份证
function ajaxCheckIdnumber() {
    $.ajax({
        url: 'http://www.dfmzdg.com/index.php/home/ajaxGetCodes',
        data: {
            full_name: $("input[name='full_name']").val(),
            id_number: $("input[name='id_number']").val()
        },
        dataType: 'json',
        type: 'post',

        beforeSend: function () {
            mask(true);
            $('#codes').html('');
        }
    }).done(function (post) {
        if (post == 'false') {
            $('#codes').html('信息有误，请输入正确的证件号和姓名！');
        } else if (post == 'none') {
            $('#codes').html('信息有误，请输入正确的证件号和姓名！');
        } else { // 如果有记录并核实正确
            if (post.group == 1) {
                g = '男子组';
            } else if (post.group == 2) {
                g = '女子组';
            } else if (post.group == 3) {
                g = '金葵花活力组';
            }

            $('#codes').html(post.code + '<br><a href="http://www.dfmzdg.com/index.php/home/letter?g=' + g +
                '&c=' + post.code + '" target="_blank" style="font-size: 20px;">打印通知书</a>');
        }

        mask(false);
    })
}

